<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
<mapper namespace="id_recipick">


	<insert id="insert_recipe" parameterType="recipeDTO">
		<selectKey keyProperty="recipe_id" resultType="int" order="BEFORE">
			select seq_reci.nextval from dual
		</selectKey> 
		insert into recipe(
						recipe_id,
						recipe_date,
						mainpic,
						maintext,
						viewer,
						uname,
						recipe_title
						)
					values(
						#{recipe_id},
						sysdate,
						#{mainpic},
						#{maintext},
						#{view},
						#{user},
						#{recipe_title}
						)
	</insert>
	
	<select id="searchData" resultType="recipeDTO" parameterType="hashmap"> <!--   -->
		SELECT * FROM RECIPE
		<where>
			recipe_title LIKE '%' || #{recipe_title} || '%'
			<if test="order == 0">
				order by recipe_id desc
			</if>
			<if test= "oreder == 1">
				order by viewer desc
			</if>
			<if test= "order == 2">
			
			</if>
		</where> 
			
	</select>
	
	<select id="searchRecipe" resultType="recipeDTO" parameterType="String"> <!--   -->
		SELECT * FROM RECIPE
		WHERE recipe_id = #{_parameter}
	</select>
	
<!-- 	김호연 -->
	<insert id="newsigninsert" parameterType="memberDTO">
			insert into MEMBER (
				uname, 
				rname, 
				email, 
				pw, 
				birth, 
				phone, 
				gender,
				guest
			) values (
				#{uname}, 
				#{rname}, 
				#{email}, 
				#{pw},  
				to_date(#{birth}, 'yyyy-mm-dd'), 
				#{phone}, 
				#{gender},
				#{guest}
			)
		</insert>
	
		<select id="loginselect" resultType="memberDTO">
			select 
				uname, pw 
			from 
				MEMBER 
			where 
				uname = #{uname} and pw = #{pw}
		</select>
		
		<select id="isDuplicateUname" resultType="memberDTO">
			select 
				uname
			from 
				MEMBER 
			where 
				uname = #{uname}
		</select>
</mapper>